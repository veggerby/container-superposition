{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "Superposition Manifest",
    "description": "Manifest file (superposition.json) generated by container-superposition to track devcontainer configuration",
    "properties": {
        "manifestVersion": {
            "type": "string",
            "description": "Schema version of the manifest (increments on breaking changes)",
            "pattern": "^[0-9]+$"
        },
        "generatedBy": {
            "type": "string",
            "description": "Version of container-superposition that created this manifest"
        },
        "version": {
            "type": "string",
            "description": "Legacy field for backward compatibility (deprecated, use manifestVersion instead)"
        },
        "generated": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp when the manifest was generated"
        },
        "baseTemplate": {
            "type": "string",
            "enum": ["plain", "compose"],
            "description": "Base devcontainer template used (plain for single image, compose for multi-service)"
        },
        "baseImage": {
            "type": "string",
            "description": "Base container image used for the devcontainer"
        },
        "overlays": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "description": "List of overlay IDs that were applied to create this configuration"
        },
        "portOffset": {
            "type": "number",
            "minimum": 0,
            "description": "Port offset applied to all service ports (optional)"
        },
        "preset": {
            "type": "string",
            "description": "ID of the preset used to generate this configuration (optional)"
        },
        "presetChoices": {
            "type": "object",
            "additionalProperties": {
                "type": "string"
            },
            "description": "User choices made within preset user-choice sections (optional)"
        },
        "autoResolved": {
            "type": "object",
            "properties": {
                "added": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "List of overlays that were automatically added as dependencies"
                },
                "reason": {
                    "type": "string",
                    "description": "Human-readable reason why dependencies were added"
                }
            },
            "required": ["added", "reason"],
            "description": "Information about automatically resolved dependencies (optional)"
        },
        "containerName": {
            "type": "string",
            "description": "Name of the container/project from devcontainer.json (optional)"
        },
        "customizations": {
            "type": "object",
            "properties": {
                "enabled": {
                    "type": "boolean",
                    "description": "Whether custom patches are enabled"
                },
                "location": {
                    "type": "string",
                    "description": "Path to custom patches directory relative to workspace"
                }
            },
            "required": ["enabled", "location"],
            "description": "Information about custom patches/overrides (optional)"
        }
    },
    "required": ["manifestVersion", "generatedBy", "generated", "baseTemplate", "baseImage", "overlays"],
    "additionalProperties": false
}
