---
applyTo: '.devcontainer/**'
---

# GitHub Copilot Instructions: Dogfooding Context

## ⚠️ Important: .devcontainer Folder is Dogfooded

The `.devcontainer/` folder in this repository is **generated by container-superposition itself** as a demonstration of the tool's capabilities (dogfooding). This has important implications for how changes should be made:

### Key Principles

1. **Generated Content**: The entire `.devcontainer/` folder is created by running:

    ```bash
    npm run init -- --stack plain --language nodejs --dev-tools codex,docker-sock,git-helpers,modern-cli-tools
    ```

2. **May Contain Duplicates**: Because the folder is auto-generated from overlays, it may contain duplicate or redundant configurations. **This is expected and should be ignored** unless it causes specific runtime problems when the devcontainer runs.

3. **Do Not Edit Generated Files Directly**: Changes to generated files (e.g., `devcontainer.json`, scripts, features) should be made in the **source overlays**, not in `.devcontainer/` directly:
    - Scripts issues → Fix in `overlays/{overlay-name}/setup.sh` or `verify.sh`
    - Feature issues → Fix in `overlays/{overlay-name}/devcontainer.patch.json`
    - Package issues → Fix in `features/cross-distro-packages/`

4. **Only Review for Runtime Concerns**: When reviewing `.devcontainer/` changes:
    - ✅ **DO review**: Runtime failures, missing dependencies, broken configuration
    - ❌ **DO NOT review**: Duplicate settings, redundant configurations, cosmetic issues

5. **Custom Directory is Special**: The `.devcontainer/custom/` folder (if it exists) contains user-specific customizations:
    - ✅ **DO review**: All changes in `.devcontainer/custom/`
    - These are intentional overrides and should be carefully evaluated

### When to Modify .devcontainer/

- **Never** for cosmetic or organizational improvements
- **Never** for removing duplicates (unless causing conflicts)
- **Only** when the devcontainer fails to build or run properly
- **Only** when testing custom patches in `.devcontainer/custom/`

### Regeneration

The `.devcontainer/` folder can be regenerated at any time:

```bash
npm run init -- --from-manifest .devcontainer/superposition.json --no-interactive
```

Any direct edits will be lost. Always modify the source overlays.
